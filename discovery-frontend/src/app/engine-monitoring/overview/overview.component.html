<!--
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!--suppress HtmlDeprecatedAttribute -->
<div [ngClass]="['ddp-ui-contents-det']">
  <!-- box status -->
  <div overview-status-view
       [clusterStatus]="clusterStatus">
  </div>
  <!-- //box status -->

  <div class="ddp-box-type ddp-type-server">
    <!-- top setting -->
    <div class="ddp-clear"
         [ngClass]="['ddp-box-top-setting']">
      <overview-search [keyword]="keyword"
                       [placeholder]="'Search server name'"
                       (changeValue)="initTableSortDirection(); searchByHostnameColumn($event)">
      </overview-search>
      <div class="ddp-type-option">
        <div overview-radio
             [selectedMonitoringStatus]="selectedMonitoringStatus"
             (changeValue)="initTableSortDirection(); searchByStatusColumn($event)">
        </div>
        <ul class="ddp-list-tab-button">
          <li>
            <a href="javascript:"><em class="ddp-icon-grid"></em></a>
            <div class="ddp-ui-tooltip-info">
              <em class="ddp-icon-view-top"></em>
              그리드 뷰
            </div>
          </li>
          <li [ngClass]="['ddp-selected']">
            <a href="javascript:"><em class="ddp-icon-listgrid"></em></a>
            <div class="ddp-ui-tooltip-info">
              <em class="ddp-icon-view-top"></em>
              리스트 뷰
            </div>
          </li>
        </ul>
      </div>
    </div>
    <!-- //top setting -->

    <div class="ddp-box-detail">
      <table class="ddp-table-detail3">
        <colgroup>
          <col width="33%">
          <col width="33%">
          <col width="33%">
        </colgroup>
        <thead>
        <tr (click)="clickHostameHeaderColumn('hostname')">
          <th>
            Server Name
            <em [class.ddp-icon-array-default2]="tableSortDirection === TABLE_SORT_DIRECTION.NONE"
                [class.ddp-icon-array-asc2]="tableSortDirection === TABLE_SORT_DIRECTION.DESC"
                [class.ddp-icon-array-des2]="tableSortDirection === TABLE_SORT_DIRECTION.ASC">
            </em>
          </th>
          <th>Node Name</th>
          <th>Status</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let monitoring of monitorings | tableSort:tableSortProperty:tableSortDirection | tableFilter:{'hostname': keyword, 'status': selectedMonitoringStatus}">
          <td>{{ monitoring.hostname }}</td>
          <td>
            <span class="ddp-data-node" [ngClass]="['type-' + monitoring.type]">
              {{ convertTypeLabel(monitoring.type) }}
            </span>
          </td>
          <td>
            <ng-template [ngIf]="monitoring.status">
              <ok-icon></ok-icon>
            </ng-template>
            <ng-template [ngIf]="!monitoring.status">
              <div class="ddp-type-status-error">
                <error-icon></error-icon>
                <span class="ddp-txt-error">
                <em class="ddp-icon-error"></em>{{ monitoring.errorTime | mdate:'YYYY-MM-DD HH:mm:ss' }}
                  <!--suppress HtmlUnknownTag -->
                  <div class="ddp-box-layout4">
                    <div class="ddp-data-title">
                      Error
                       <span class="ddp-sub-title">({{ monitoring.errorDuration }})</span>
                    </div>
                    <div class="ddp-data-det">
                      {{ monitoring.hostname }}:{{ monitoring.port }} {{ monitoring.type }} node<br>
                      Failure time : {{ monitoring.errorTime | mdate:'YYYY-MM-DD HH:mm:ss' }}
                  </div>
                  </div>
                </span>
              </div>
            </ng-template>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
